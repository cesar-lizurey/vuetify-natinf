(function(p,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(p=typeof globalThis<"u"?globalThis:p||self,e(p.VuetifyNATINF={},p.Vue))})(this,function(p,e){"use strict";const f={"Contravention de 1ère classe":{abr:"C1",couleur:"primary"},"Contravention de 2ème classe":{abr:"C2",couleur:"primary"},"Contravention de 3ème classe":{abr:"C3",couleur:"primary"},"Contravention de 4ème classe":{abr:"C4",couleur:"primary"},"Contravention de 5ème classe":{abr:"C5",couleur:"primary"},Délit:{abr:"D",couleur:"warning"},Crime:{abr:"Cr",couleur:"error"}};async function h(t){try{return(await(await fetch(`https://tabular-api.data.gouv.fr/api/resources/3899108b-262c-46d4-8283-1c70f1cf4326/data/?Numéro NATINF__exact=${t}`,{method:"GET",credentials:"include"})).json()).data[0]||!1}catch{return console.error("NATINF introuvable"),!1}}const _=(t,o)=>{const r=t.__vccOpts||t;for(const[a,n]of o)r[a]=n;return r},b=e.defineComponent({name:"CarteNATINF",props:{natinf:{type:Number,required:!0,default:0}},async setup(t){const{natinf:o}=e.toRefs(t),r=await h(o.value);return{NATINFAffiche:e.computed(()=>{if(r)return{nature:r["Unnamed: 1"]||"",couleur:f[r["Unnamed: 1"]].couleur||"primary",texte:r["Unnamed: 2"]||"INTROUVABLE",prevuPar:r["Unnamed: 3"],reprimePar:r["Unnamed: 4"]}})}}});function F(t,o,r,a,n,m){const i=e.resolveComponent("v-toolbar-title"),s=e.resolveComponent("v-toolbar"),c=e.resolveComponent("v-list-item"),N=e.resolveComponent("v-list"),d=e.resolveComponent("v-divider"),l=e.resolveComponent("v-list-subheader"),u=e.resolveComponent("v-card"),x=e.resolveComponent("v-alert");return t.NATINFAffiche?(e.openBlock(),e.createBlock(u,{key:0,class:"mx-auto bg-surface","max-width":"400"},{default:e.withCtx(()=>[e.createVNode(s,{color:t.NATINFAffiche.couleur},{default:e.withCtx(()=>[e.createVNode(i,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.natinf),1)]),_:1})]),_:1},8,["color"]),e.createVNode(N,{lines:"three",class:"mx-auto bg-surface-variant"},{default:e.withCtx(()=>[e.createVNode(c,{title:t.NATINFAffiche.nature,subtitle:t.NATINFAffiche.texte},null,8,["title","subtitle"])]),_:1}),e.createVNode(d),e.createVNode(N,{class:"mx-auto bg-surface-variant"},{default:e.withCtx(()=>[e.createVNode(l,null,{default:e.withCtx(()=>o[0]||(o[0]=[e.createTextVNode("Prévue par")])),_:1}),e.createVNode(c,{lines:"three",subtitle:t.NATINFAffiche.prevuPar},null,8,["subtitle"]),e.createVNode(l,null,{default:e.withCtx(()=>o[1]||(o[1]=[e.createTextVNode("Réprimée par")])),_:1}),e.createVNode(c,{lines:"three",subtitle:t.NATINFAffiche.reprimePar},null,8,["subtitle"])]),_:1})]),_:1})):(e.openBlock(),e.createBlock(x,{key:1,type:"error"},{default:e.withCtx(()=>o[2]||(o[2]=[e.createTextVNode(" NATINF introuvable ")])),_:1}))}const C=_(b,[["render",F]]),I=e.defineComponent({name:"CartoucheNATINF",props:{natinf:{type:Number,required:!0,default:0}},async setup(t){const{natinf:o}=e.toRefs(t),r=e.ref(!1),a=await h(o.value);return{NATINFAffiche:e.computed(()=>{if(a)return{couleur:f[a["Unnamed: 1"]].couleur||"primary",abr:`[${f[a["Unnamed: 1"]].abr}]`||"",texte:`${o.value} ${a["Unnamed: 2"]}`||"INTROUVABLE",prevuPar:a["Unnamed: 3"],reprimePar:a["Unnamed: 4"]}}),menu:r}}});function V(t,o,r,a,n,m){const i=e.resolveComponent("v-btn"),s=e.resolveComponent("v-list-item"),c=e.resolveComponent("v-list"),N=e.resolveComponent("v-card"),d=e.resolveComponent("v-menu"),l=e.resolveComponent("v-chip");return t.NATINFAffiche?(e.openBlock(),e.createBlock(d,{key:0,modelValue:t.menu,"onUpdate:modelValue":o[0]||(o[0]=u=>t.menu=u),"close-on-content-click":!1,location:"end"},{activator:e.withCtx(({props:u})=>[e.createVNode(i,e.mergeProps({size:"x-small",color:t.NATINFAffiche.couleur},u,{class:"ma-2",variant:"outlined"}),{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.NATINFAffiche.abr)+" "+e.toDisplayString(t.NATINFAffiche.texte),1)]),_:2},1040,["color"])]),default:e.withCtx(()=>[e.createVNode(N,null,{default:e.withCtx(()=>[e.createVNode(c,{density:"compact"},{default:e.withCtx(()=>[e.createVNode(s,{variant:"tonal",title:"Prévue par"}),e.createVNode(s,{lines:"three",subtitle:t.NATINFAffiche.prevuPar},null,8,["subtitle"]),e.createVNode(s,{variant:"tonal",title:"Réprimée par"}),e.createVNode(s,{lines:"three",subtitle:t.NATINFAffiche.reprimePar},null,8,["subtitle"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):(e.openBlock(),e.createBlock(l,{key:1,color:"error",class:"ma-2","prepend-icon":"mdi-alert",size:"x-small"},{default:e.withCtx(()=>o[1]||(o[1]=[e.createTextVNode(" NATINF introuvable ")])),_:1}))}const A=_(I,[["render",V]]),y="https://tabular-api.data.gouv.fr/api/resources/3899108b-262c-46d4-8283-1c70f1cf4326/data/?",T={__name:"RechercheNATINF",props:e.mergeModels({multiple:{type:Boolean,default:!1}},{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,{multiple:r}=e.toRefs(o),a=e.useModel(t,"modelValue"),n=e.reactive({resultats:[],aChercher:null,enCours:!1,recherche:null});return e.watch(()=>n.aChercher,m=>{!m||(m==null?void 0:m.length)===0||n.enCours||(clearTimeout(n.recherche),n.recherche=setTimeout(async()=>{n.enCours=!0;let i;const s=parseFloat(m);!isNaN(s)&&isFinite(s)?i="Numéro NATINF__exact":i="Qualification de l'infraction__contains",fetch(`${y}${i}=${m}`,{method:"GET",credentials:"include"}).then(c=>c.json()).then(c=>{n.resultats=[...c.data]}).catch(c=>{console.log(c)}).finally(()=>{n.enCours=!1})},1500))}),(m,i)=>{const s=e.resolveComponent("v-chip"),c=e.resolveComponent("v-list-item"),N=e.resolveComponent("v-autocomplete");return e.openBlock(),e.createBlock(N,{modelValue:a.value,"onUpdate:modelValue":i[0]||(i[0]=d=>a.value=d),search:n.aChercher,"onUpdate:search":i[1]||(i[1]=d=>n.aChercher=d),"no-filter":"","return-object":"",items:n.resultats,loading:n.enCours,"item-title":"Qualification de l'infraction",label:"Code NATINF ou texte",placeholder:"Commencez à écrire...","prepend-icon":"mdi-scale-balance",multiple:e.unref(r),chips:"","closable-chips":"",clearable:""},{chip:e.withCtx(({props:d,item:l})=>[e.createVNode(s,e.mergeProps(d,{color:(e.unref(f)[l.raw["Nature de l'infraction"]]||{}).couleur||"primary",text:`[${(e.unref(f)[l.raw["Nature de l'infraction"]]||{}).abr||""}] ${l.raw["Numéro NATINF"]} - ${l.raw["Qualification de l'infraction"]}`}),null,16,["color","text"])]),item:e.withCtx(({props:d,item:l})=>[e.createVNode(c,e.mergeProps(d,{title:l.raw["Qualification de l'infraction"],subtitle:l.raw["Numéro NATINF"]}),{prepend:e.withCtx(()=>[e.createVNode(s,{size:"x-small",color:(e.unref(f)[l.raw["Nature de l'infraction"]]||{}).couleur||"primary",class:"mr-2",label:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString((e.unref(f)[l.raw["Nature de l'infraction"]]||{}).abr||""),1)]),_:2},1032,["color"])]),_:2},1040,["title","subtitle"])]),_:1},8,["modelValue","search","items","loading","multiple"])}}},w={install(t){t.component("CarteNATINF",C),t.component("CartoucheNATINF",A),t.component("RechercheNATINF",T)}};p.CarteNATINF=C,p.CartoucheNATINF=A,p.RechercheNATINF=T,p.default=w,Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
