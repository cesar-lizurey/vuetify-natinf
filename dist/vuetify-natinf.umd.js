(function(f,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(f=typeof globalThis<"u"?globalThis:f||self,e(f.VuetifyNATINF={},f.Vue))})(this,function(f,e){"use strict";const m={"Contravention de 1ère classe":{abr:"C1",couleur:"primary"},"Contravention de 2ème classe":{abr:"C2",couleur:"primary"},"Contravention de 3ème classe":{abr:"C3",couleur:"primary"},"Contravention de 4ème classe":{abr:"C4",couleur:"primary"},"Contravention de 5ème classe":{abr:"C5",couleur:"primary"},Délit:{abr:"D",couleur:"warning"},Crime:{abr:"Cr",couleur:"error"}};async function h(t){try{return(await(await fetch(`https://tabular-api.data.gouv.fr/api/resources/3899108b-262c-46d4-8283-1c70f1cf4326/data/?Numéro NATINF__exact=${t}`,{method:"GET",credentials:"include"})).json()).data[0]||!1}catch{return console.error("NATINF introuvable"),!1}}const _=(t,r)=>{const n=t.__vccOpts||t;for(const[a,o]of r)n[a]=o;return n},b=e.defineComponent({name:"CarteNATINF",props:{natinf:{type:Number,required:!0,default:0}},async setup(t){const{natinf:r}=e.toRefs(t),n=await h(r.value);return{NATINFAffiche:e.computed(()=>{var o;if(n)return{nature:n["Nature de l'infraction"]||"",couleur:((o=m[n["Nature de l'infraction"]])==null?void 0:o.couleur)||"primary",texte:n["Qualification de l'infraction"]||"INTROUVABLE",prevuPar:n["Définie par"],reprimePar:n["Réprimée par"]}})}}});function F(t,r,n,a,o,s){const l=e.resolveComponent("v-toolbar-title"),p=e.resolveComponent("v-toolbar"),c=e.resolveComponent("v-list-item"),N=e.resolveComponent("v-list"),d=e.resolveComponent("v-divider"),i=e.resolveComponent("v-list-subheader"),u=e.resolveComponent("v-card"),x=e.resolveComponent("v-alert");return t.NATINFAffiche?(e.openBlock(),e.createBlock(u,{key:0,class:"mx-auto bg-surface","max-width":"400"},{default:e.withCtx(()=>[e.createVNode(p,{color:t.NATINFAffiche.couleur},{default:e.withCtx(()=>[e.createVNode(l,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.natinf),1)]),_:1})]),_:1},8,["color"]),e.createVNode(N,{lines:"three",class:"mx-auto bg-surface-variant"},{default:e.withCtx(()=>[e.createVNode(c,{title:t.NATINFAffiche.nature,subtitle:t.NATINFAffiche.texte},null,8,["title","subtitle"])]),_:1}),e.createVNode(d),e.createVNode(N,{class:"mx-auto bg-surface-variant"},{default:e.withCtx(()=>[e.createVNode(i,null,{default:e.withCtx(()=>r[0]||(r[0]=[e.createTextVNode("Prévue par")])),_:1}),e.createVNode(c,{lines:"three",subtitle:t.NATINFAffiche.prevuPar},null,8,["subtitle"]),e.createVNode(i,null,{default:e.withCtx(()=>r[1]||(r[1]=[e.createTextVNode("Réprimée par")])),_:1}),e.createVNode(c,{lines:"three",subtitle:t.NATINFAffiche.reprimePar},null,8,["subtitle"])]),_:1})]),_:1})):(e.openBlock(),e.createBlock(x,{key:1,type:"error"},{default:e.withCtx(()=>r[2]||(r[2]=[e.createTextVNode(" NATINF introuvable ")])),_:1}))}const C=_(b,[["render",F]]),I=e.defineComponent({name:"CartoucheNATINF",props:{natinf:{type:Number,required:!0,default:0}},async setup(t){const{natinf:r}=e.toRefs(t),n=e.ref(!1),a=await h(r.value);return{NATINFAffiche:e.computed(()=>{var s,l;if(a)return{couleur:((s=m[a["Nature de l'infraction"]])==null?void 0:s.couleur)||"primary",abr:(l=m[a["Nature de l'infraction"]])!=null&&l.abr?`[${m[a["Nature de l'infraction"]].abr}]`:"",texte:`${r.value} ${a["Qualification de l'infraction"]}`||"INTROUVABLE",prevuPar:a["Définie par"],reprimePar:a["Réprimée par"]}}),menu:n}}});function V(t,r,n,a,o,s){const l=e.resolveComponent("v-btn"),p=e.resolveComponent("v-list-item"),c=e.resolveComponent("v-list"),N=e.resolveComponent("v-card"),d=e.resolveComponent("v-menu"),i=e.resolveComponent("v-chip");return t.NATINFAffiche?(e.openBlock(),e.createBlock(d,{key:0,modelValue:t.menu,"onUpdate:modelValue":r[0]||(r[0]=u=>t.menu=u),"close-on-content-click":!1,location:"end"},{activator:e.withCtx(({props:u})=>[e.createVNode(l,e.mergeProps({size:"x-small",color:t.NATINFAffiche.couleur},u,{class:"ma-2",variant:"outlined"}),{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.NATINFAffiche.abr)+" "+e.toDisplayString(t.NATINFAffiche.texte),1)]),_:2},1040,["color"])]),default:e.withCtx(()=>[e.createVNode(N,null,{default:e.withCtx(()=>[e.createVNode(c,{density:"compact"},{default:e.withCtx(()=>[e.createVNode(p,{variant:"tonal",title:"Prévue par"}),e.createVNode(p,{lines:"three",subtitle:t.NATINFAffiche.prevuPar},null,8,["subtitle"]),e.createVNode(p,{variant:"tonal",title:"Réprimée par"}),e.createVNode(p,{lines:"three",subtitle:t.NATINFAffiche.reprimePar},null,8,["subtitle"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):(e.openBlock(),e.createBlock(i,{key:1,color:"error",class:"ma-2","prepend-icon":"mdi-alert",size:"x-small"},{default:e.withCtx(()=>r[1]||(r[1]=[e.createTextVNode(" NATINF introuvable ")])),_:1}))}const A=_(I,[["render",V]]),y="https://tabular-api.data.gouv.fr/api/resources/3899108b-262c-46d4-8283-1c70f1cf4326/data/?",T={__name:"RechercheNATINF",props:e.mergeModels({multiple:{type:Boolean,default:!1}},{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const r=t,{multiple:n}=e.toRefs(r),a=e.useModel(t,"modelValue"),o=e.reactive({resultats:[],aChercher:null,enCours:!1,recherche:null});return e.watch(()=>o.aChercher,s=>{!s||(s==null?void 0:s.length)===0||o.enCours||(clearTimeout(o.recherche),o.recherche=setTimeout(async()=>{o.enCours=!0;let l;const p=parseFloat(s);!isNaN(p)&&isFinite(p)?l="Numéro NATINF__exact":l="Qualification de l'infraction__contains",fetch(`${y}${l}=${s}`,{method:"GET",credentials:"include"}).then(c=>c.json()).then(c=>{o.resultats=[...c.data]}).catch(c=>{console.log(c)}).finally(()=>{o.enCours=!1})},1500))}),(s,l)=>{const p=e.resolveComponent("v-chip"),c=e.resolveComponent("v-list-item"),N=e.resolveComponent("v-autocomplete");return e.openBlock(),e.createBlock(N,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=d=>a.value=d),search:o.aChercher,"onUpdate:search":l[1]||(l[1]=d=>o.aChercher=d),"no-filter":"","return-object":"",items:o.resultats,loading:o.enCours,"item-title":"Qualification de l'infraction",label:"Code NATINF ou texte",placeholder:"Commencez à écrire...","prepend-icon":"mdi-scale-balance",multiple:e.unref(n),chips:"","closable-chips":"",clearable:""},{chip:e.withCtx(({props:d,item:i})=>[e.createVNode(p,e.mergeProps(d,{color:(e.unref(m)[i.raw["Nature de l'infraction"]]||{}).couleur||"primary",text:`[${(e.unref(m)[i.raw["Nature de l'infraction"]]||{}).abr||""}] ${i.raw["Numéro NATINF"]} - ${i.raw["Qualification de l'infraction"]}`}),null,16,["color","text"])]),item:e.withCtx(({props:d,item:i})=>[e.createVNode(c,e.mergeProps(d,{title:i.raw["Qualification de l'infraction"],subtitle:i.raw["Numéro NATINF"]}),{prepend:e.withCtx(()=>[e.createVNode(p,{size:"x-small",color:(e.unref(m)[i.raw["Nature de l'infraction"]]||{}).couleur||"primary",class:"mr-2",label:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString((e.unref(m)[i.raw["Nature de l'infraction"]]||{}).abr||""),1)]),_:2},1032,["color"])]),_:2},1040,["title","subtitle"])]),_:1},8,["modelValue","search","items","loading","multiple"])}}},w={install(t){t.component("CarteNATINF",C),t.component("CartoucheNATINF",A),t.component("RechercheNATINF",T)}};f.CarteNATINF=C,f.CartoucheNATINF=A,f.RechercheNATINF=T,f.default=w,Object.defineProperties(f,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
