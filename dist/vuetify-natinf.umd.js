(function(c,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(c=typeof globalThis<"u"?globalThis:c||self,e(c.VuetifyNATINF={},c.Vue))})(this,function(c,e){"use strict";const C=(t,l)=>{const m=t.__vccOpts||t;for(const[s,o]of l)m[s]=o;return m},b=e.defineComponent({name:"CartoucheNATINF",props:{natinf:{type:Number,required:!0,default:0}},async setup(t){const{natinf:l}=e.toRefs(t),m=e.ref(!1),s={"Contravention de 1ère classe":{abr:"C1",couleur:"primary"},"Contravention de 2ème classe":{abr:"C2",couleur:"primary"},"Contravention de 3ème classe":{abr:"C3",couleur:"primary"},"Contravention de 4ème classe":{abr:"C4",couleur:"primary"},"Contravention de 5ème classe":{abr:"C5",couleur:"primary"},Délit:{abr:"D",couleur:"warning"},Crime:{abr:"Cr",couleur:"error"}},n=await fetch(`https://tabular-api.data.gouv.fr/api/resources/c6fb5b37-b3bc-4904-bd26-1b29ad7391df/data/?Ministère de la Justice, Direction des affaires criminelles et__exact=${l.value}`,{method:"GET",credentials:"include"}).then(i=>i.json()).then(i=>i.data[0]).catch(()=>({introuvable:!0})),r=e.computed(()=>{if(n)return{infobulle:n["Unnamed: 1"]||"",couleur:s[n["Unnamed: 1"]].couleur||"primary",abr:`[${s[n["Unnamed: 1"]].abr}]`||"",texte:`${l.value} ${n["Unnamed: 2"]}`||"INTROUVABLE",prevuPar:n["Unnamed: 3"],reprimePar:n["Unnamed: 4"]}});return{correspondancesNatures:s,NATINFAffiche:r,detailsNATINF:n,menu:m}}});function _(t,l,m,s,o,n){const r=e.resolveComponent("v-chip"),i=e.resolveComponent("v-btn"),a=e.resolveComponent("v-list-item"),u=e.resolveComponent("v-list"),d=e.resolveComponent("v-card"),p=e.resolveComponent("v-menu");return!t.detailsNATINF||t.detailsNATINF.introuvable?(e.openBlock(),e.createBlock(r,{key:0,color:"error",class:"ma-2","prepend-icon":"mdi-alert",size:"small"},{default:e.withCtx(()=>l[1]||(l[1]=[e.createTextVNode(" NATINF introuvable ")])),_:1})):(e.openBlock(),e.createBlock(p,{key:1,modelValue:t.menu,"onUpdate:modelValue":l[0]||(l[0]=f=>t.menu=f),"close-on-content-click":!1,location:"end"},{activator:e.withCtx(({props:f})=>[e.createVNode(i,e.mergeProps({size:"x-small",color:t.NATINFAffiche.couleur},f,{class:"ma-2",variant:"outlined"}),{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.NATINFAffiche.abr)+" "+e.toDisplayString(t.NATINFAffiche.texte),1)]),_:2},1040,["color"])]),default:e.withCtx(()=>[e.createVNode(d,null,{default:e.withCtx(()=>[e.createVNode(u,{density:"compact"},{default:e.withCtx(()=>[e.createVNode(a,{variant:"tonal",title:"Prévue par"}),e.createVNode(a,{title:t.NATINFAffiche.prevuPar},null,8,["title"]),e.createVNode(a,{variant:"tonal",title:"Réprimée par"}),e.createVNode(a,{title:t.NATINFAffiche.reprimePar},null,8,["title"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}const h=C(b,[["render",_]]),T="https://tabular-api.data.gouv.fr/api/resources/c6fb5b37-b3bc-4904-bd26-1b29ad7391df/data/?",N={__name:"RechercheNATINF",props:e.mergeModels({multiple:{type:Boolean,default:!1}},{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const l=t,{multiple:m}=e.toRefs(l),s=e.useModel(t,"modelValue"),o=e.reactive({resultats:[],aChercher:null,enCours:!1,recherche:null});return e.watch(()=>o.aChercher,n=>{!n||(n==null?void 0:n.length)===0||o.enCours||(clearTimeout(o.recherche),o.recherche=setTimeout(async()=>{o.enCours=!0;let r;const i=parseFloat(n);!isNaN(i)&&isFinite(i)?r="Ministère de la Justice, Direction des affaires criminelles et__exact":r="Unnamed: 2__contains",fetch(`${T}${r}=${n}`,{method:"GET",credentials:"include"}).then(a=>a.json()).then(a=>{o.resultats=[...a.data]}).catch(a=>{console.log(a)}).finally(()=>{o.enCours=!1})},1500))}),(n,r)=>{const i=e.resolveComponent("v-chip"),a=e.resolveComponent("v-list-item"),u=e.resolveComponent("v-autocomplete");return e.openBlock(),e.createBlock(u,{modelValue:s.value,"onUpdate:modelValue":r[0]||(r[0]=d=>s.value=d),search:o.aChercher,"onUpdate:search":r[1]||(r[1]=d=>o.aChercher=d),"no-filter":"","return-object":"",items:o.resultats,loading:o.enCours,"item-title":"nom",label:"Code NATINF ou texte",placeholder:"Commencez à écrire...","prepend-icon":"mdi-scale-balance",multiple:e.unref(m),chips:"","closable-chips":"",clearable:""},{chip:e.withCtx(({props:d,item:p})=>[e.createVNode(i,e.mergeProps(d,{"prepend-icon":"mdi-scale-balance",text:`[${p.raw["Ministère de la Justice, Direction des affaires criminelles et"]}] ${p.raw["Unnamed: 2"]}`}),null,16,["text"])]),item:e.withCtx(({props:d,item:p})=>[e.createVNode(a,e.mergeProps(d,{"prepend-icon":"mdi-scale-balance",title:p.raw["Unnamed: 2"],subtitle:p.raw["Ministère de la Justice, Direction des affaires criminelles et"]}),null,16,["title","subtitle"])]),_:1},8,["modelValue","search","items","loading","multiple"])}}},A={install(t){t.component("CartoucheNATINF",h),t.component("RechercheNATINF",N)}};c.CartoucheNATINF=h,c.RechercheNATINF=N,c.default=A,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
